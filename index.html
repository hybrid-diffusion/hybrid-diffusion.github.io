<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Hybrid Diffusion Planning</title>

    <meta name="description" content="Hybrid Diffusion Planning">
    <meta name="viewport" content="width=device-width, initial-scale=1">


     <!--FACEBOOK-->
     <meta property="og:image" content="./img/share_image.png">
     <meta property="og:image:type" content="image/png">
     <meta property="og:image:width" content="1196">
     <meta property="og:image:height" content="705">
     <meta property="og:type" content="website" />
     <meta property="og:url" content="https://hybrid-diffusion-planning.github.io/"/>
     <meta property="og:title" content="Hybrid Diffusion Planning" />
     <meta property="og:description"
         content="Project page for Hybrid Diffusion Planning." />
 
     <!--TWITTER-->
     <meta name="twitter:card" content="summary_large_image" />
     <meta name="twitter:title" content="Hybrid Diffusion Planning" />
     <meta name="twitter:description"
         content="Project page for Hybrid Diffusion Planning" />
     <meta name="twitter:image" content="./img/share_image.png" />

     

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    

	
    <style>
        .nav-pills {
          position: relative;
          display: inline;
        }
        .imtip {
          position: absolute;
          top: 0;
          left: 0;
        }
        .booktabs-table {
          border-collapse: separate;
          border-spacing: 0;
        }
        .booktabs-table thead th {
          border-top: 3px solid #222;
          border-bottom: 2px solid #222;
          background: #f8f9fa;
        }
        .booktabs-table tbody tr:last-child td {
          border-bottom: 3px solid #222;
        }
        .booktabs-table th,
        .booktabs-table td {
          border: none !important;
        }

    </style>
</head>
<!-- Google tag (gtag.js) -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-5JBS73F70V"></script> -->
<!-- <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5JBS73F70V');
</script> -->
<body>
    <div class="container">
        <div class="row mt-4">
            <h2 class="col-md-12 text-center">
                <b><font size="+6">Hybrid Diffusion Planning</font></b></br> 
            </h2>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 col-lg-8 mx-auto">
                <h3 class="mt-4 mb-2">Abstract</h3>
                <p class="text-justify">
                    Constructing robots to accomplish long-horizon tasks is a long-standing challenge within artificial intelligence. Approaches using generative methods, particularly Diffusion Models, have gained attention due to their ability to model continuous robotic trajectories for planning and control. However, we show that these models struggle with long-horizon tasks that involve complex decision-making and, in general, are prone to confusing different modes of behavior, leading to failure. To remedy this, we propose to augment continuous trajectory generation by simultaneously generating a high-level symbolic plan. We show that this requires a novel mix of discrete variable diffusion and continuous diffusion, which dramatically outperforms the baselines. In addition, we illustrate how this hybrid diffusion process enables flexible trajectory synthesis, allowing us to condition synthesized actions on partial and complete discrete conditions.
                </p>
                <div class="text-center mt-4">
                    <img src="img/Teaser.png" alt="Teaser" class="img-fluid">
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 col-lg-8 mx-auto">
                <p class="text-justify">
                    Trajectory-only Diffusion Models struggle with long-horizon decision making tasks, such as sorting tasks. These are highly multimodal tasks, and while all demonstrations terminate in a sorted state, the trained model mix behaviours in the dataset, resulting in flawed plans. Hybrid Diffusion Planning (HDP), by combining the planning task with the diffusion of a discrete symbolic plan, however, shows remarkable ability to solve complex tasks.
                </p>
                <div class="row">
                    <div class="col-md-6 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/Diffuser denoising and execution.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h5 class="mt-2">Trajectory-only Diffusion</h5>
                    </div>
                    <div class="col-md-6 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/Denoising_and _execution_hybrid.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h5 class="mt-2">Hybrid Diffusion Planning</h5>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 col-lg-8 mx-auto">
                <h3 class="mb-3">Simulated tasks</h3>
                <!-- Videos -->
                <div class="row mt-4">
                    <div class="col-md-4 mb-4 text-center">
                        <video class="w-100 mb-3" controls>
                            <source src="videos/hybrid_xarm_sorting_compressed.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <h5 class="mt-2">X-Arm Sorting</h5>
                    </div>
                    <div class="col-md-4 mb-4 text-center">
                        <video class="w-100 mb-3" controls>
                            <source src="videos/hybrid_xarm_pick_place_compressed.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <h5 class="mt-2">Arrange Blocks</h5>
                    </div>
                    <div class="col-md-4 mb-4 text-center">
                        <video id="hook-video" class="w-100 mb-3" controls>
                            <source src="videos/hook_rollout.webm" type="video/webm">
                            Your browser does not support the video tag.
                        </video>
                        <h5 class="mt-2">Hook Task</h5>
                    </div>
                </div>

                <!-- Table -->
                <div class="row align-items-start">
                    <div class="col-md-9 mx-auto mb-4">
                        <table class="table booktabs-table text-center align-middle mb-0">
                            <thead>
                                <tr>
                                    <th>Method</th>
                                    <th>X-Arm<br>Sorting</th>
                                    <th>Arrange<br>Blocks</th>
                                    <th>Hook<br>Task</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Diffuser</td>
                                    <td>46%</td>
                                    <td>67%</td>
                                    <td>38%</td>
                                </tr>
                                <tr>
                                    <td>Joint Diffuser</td>
                                    <td>41%</td>
                                    <td>61%</td>
                                    <td>48%</td>
                                </tr>
                                <tr>
                                    <td>Separate Diffuser</td>
                                    <td>38%</td>
                                    <td>62%</td>
                                    <td>43%</td>
                                </tr>
                                <tr>
                                    <td><b>Hybrid (Ours)</b></td>
                                    <td><b>83%</b></td>
                                    <td><b>74%</b></td>
                                    <td><b>60%</b></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 col-lg-8 mx-auto">
                <p class="text-justify">
                    In addition to experimental benchmarks, we measure the robustness of all methods as task complexity increases by varying the number of blocks to sort. We find that Hybrid Diffusion Planning is significantly stronger than the baselines. 
                </p>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-md-10 col-lg-8 mx-auto text-center">
                <img src="img/bar_plot.png" alt="Bar Plot" class="img-fluid" style="width: 75%;">
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 col-lg-8 mx-auto">
                <div class="row">
                    <div class="col-md-4 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/Hybrid_2_block_execution.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h6 class="mt-2">2 Blocks</h6>
                    </div>
                    <div class="col-md-4 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/hybrid_3_block_execution.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h6 class="mt-2">3 Blocks</h6>
                    </div>
                    <div class="col-md-4 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/hybrid_4_block_execution.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h6 class="mt-2">4 Blocks</h6>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 col-lg-8 mx-auto">
                <h3 class="mb-3">Real-world Evaluation</h3>
                <div class="row mt-4">
                    <div class="col-md-6 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/real_sorting_compressed.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h5 class="mt-2">Real Sorting Task</h5>
                    </div>
                    <div class="col-md-6 text-center mb-4">
                        <div class="ratio ratio-16x9">
                            <video controls>
                                <source src="videos/Real_hook_hybrid_compressed.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <h5 class="mt-2">Real Hook Task</h5>
                    </div>
                </div>
                <div class="row align-items-start mt-4">
                    <div class="col-md-9 mx-auto mb-4">
                        <table class="table booktabs-table text-center align-middle mb-0">
                            <thead>
                                <tr>
                                    <th>Method</th>
                                    <th>Sorting Task</th>
                                    <th>Hook Task</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Diffuser</td>
                                    <td>20%</td>
                                    <td>6.7%</td>
                                </tr>
                                <tr>
                                    <td>Joint Diffuser</td>
                                    <td>10%</td>
                                    <td>10%</td>
                                </tr>
                                <tr>
                                    <td>Separate Diffuser</td>
                                    <td>0%</td>
                                    <td>6.7%</td>
                                </tr>
                                <tr>
                                    <td><b>Hybrid (Ours)</b></td>
                                    <td><b>70%</b></td>
                                    <td><b>60%</b></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>        
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('hook-video').playbackRate = 0.5;
        document.getElementById('hook-video').addEventListener('loadedmetadata', function() {
            this.playbackRate = 0.5;
        });
    </script>
</body>
</html>
